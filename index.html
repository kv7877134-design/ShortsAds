<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShortsAds - Реклама в YouTube Shorts</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }
        
        nav ul li a:hover {
            opacity: 0.8;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
            text-decoration: none;
        }
        
        .btn:hover {
            background-color: var(--secondary);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-warning {
            background-color: var(--warning);
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .hidden {
            display: none;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--primary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tariff-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .tariff-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .tariff-card:hover {
            transform: translateY(-5px);
        }
        
        .tariff-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .tariff-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .tariff-duration {
            margin-bottom: 15px;
            color: #666;
        }
        
        .admin-panel {
            background-color: #f8f9fa;
            border-left: 4px solid var(--danger);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .admin-panel h3 {
            color: var(--danger);
            margin-bottom: 10px;
        }
        
        .support-chat {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f9f9f9;
        }
        
        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            max-width: 80%;
        }
        
        .user-message {
            background-color: #e3f2fd;
            margin-left: auto;
        }
        
        .admin-message {
            background-color: #fff3e0;
        }
        
        .balance {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        footer {
            background-color: var(--dark);
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 15px;
                justify-content: center;
            }
            
            .tariff-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">ShortsAds</div>
                <nav>
                    <ul>
                        <li><a href="#" id="nav-home">Главная</a></li>
                        <li><a href="#" id="nav-tariffs">Тарифы</a></li>
                        <li><a href="#" id="nav-support">Поддержка</a></li>
                        <li><a href="#" id="nav-account">Аккаунт</a></li>
                        <li><a href="#" id="nav-admin" class="hidden">Админ-панель</a></li>
                        <li><a href="#" id="nav-login">Войти</a></li>
                        <li><a href="#" id="nav-register">Регистрация</a></li>
                        <li><a href="#" id="nav-logout" class="hidden">Выйти</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Главная страница -->
        <div id="home-page" class="tab-content active">
            <div class="card">
                <h1>ShortsAds - Реклама в YouTube Shorts</h1>
                <p>Размещайте рекламу в YouTube Shorts и получайте доход за просмотры, лайки и комментарии!</p>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="total-users">0</div>
                        <div class="stat-label">Пользователей</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-ads">0</div>
                        <div class="stat-label">Размещено реклам</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-earnings">0₽</div>
                        <div class="stat-label">Общий доход</div>
                    </div>
                </div>
                
                <h2>Как это работает?</h2>
                <ol>
                    <li>Зарегистрируйтесь на платформе</li>
                    <li>Выберите тариф размещения рекламы</li>
                    <li>Заполните анкету с данными о рекламе</li>
                    <li>Админ проверит и одобрит вашу заявку</li>
                    <li>Разместите рекламу в своем YouTube Shorts</li>
                    <li>Получайте доход за просмотры, лайки и комментарии</li>
                    <li>Подтвердите статистику и выводите средства</li>
                </ol>
                
                <h2>Доход за взаимодействия</h2>
                <ul>
                    <li>Просмотр: 0.005₽</li>
                    <li>Лайк: 0.01₽</li>
                    <li>Комментарий: 0.02₽</li>
                </ul>
                
                <div class="btn" id="start-earning-btn">Начать зарабатывать</div>
            </div>
        </div>

        <!-- Тарифы -->
        <div id="tariffs-page" class="tab-content">
            <div class="card">
                <h2>Тарифы размещения рекламы</h2>
                <p>Выберите подходящий тариф для размещения рекламы в вашем YouTube Shorts</p>
                
                <div class="tariff-cards">
                    <div class="tariff-card">
                        <div class="tariff-name">Супер эконом</div>
                        <div class="tariff-price">30₽</div>
                        <div class="tariff-duration">12 часов</div>
                        <button class="btn" data-tariff="super-economy">Выбрать</button>
                    </div>
                    <div class="tariff-card">
                        <div class="tariff-name">Эконом</div>
                        <div class="tariff-price">120₽</div>
                        <div class="tariff-duration">24 часа</div>
                        <button class="btn" data-tariff="economy">Выбрать</button>
                    </div>
                    <div class="tariff-card">
                        <div class="tariff-name">Средничок</div>
                        <div class="tariff-price">500₽</div>
                        <div class="tariff-duration">6 дней</div>
                        <button class="btn" data-tariff="medium">Выбрать</button>
                    </div>
                    <div class="tariff-card">
                        <div class="tariff-name">Профи</div>
                        <div class="tariff-price">3.500₽</div>
                        <div class="tariff-duration">12 дней</div>
                        <button class="btn" data-tariff="pro">Выбрать</button>
                    </div>
                    <div class="tariff-card">
                        <div class="tariff-name">Эксперт</div>
                        <div class="tariff-price">7.500₽</div>
                        <div class="tariff-duration">24 дня</div>
                        <button class="btn" data-tariff="expert">Выбрать</button>
                    </div>
                    <div class="tariff-card">
                        <div class="tariff-name">Бизнесмен</div>
                        <div class="tariff-price">30.000₽</div>
                        <div class="tariff-duration">48 дней</div>
                        <button class="btn" data-tariff="business">Выбрать</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Поддержка -->
        <div id="support-page" class="tab-content">
            <div class="card">
                <h2>Поддержка</h2>
                <p>Здесь вы можете задать вопросы нашей поддержке</p>
                
                <div class="support-chat" id="support-chat">
                    <!-- Сообщения будут добавляться здесь -->
                </div>
                
                <div class="form-group">
                    <textarea id="support-message" placeholder="Введите ваше сообщение..." rows="3"></textarea>
                </div>
                <button class="btn" id="send-support-message">Отправить</button>
            </div>
        </div>

        <!-- Аккаунт -->
        <div id="account-page" class="tab-content">
            <div class="card">
                <h2>Личный кабинет</h2>
                
                <div class="balance">Баланс: <span id="user-balance">0</span>₽</div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="profile">Профиль</div>
                    <div class="tab" data-tab="ads">Мои рекламы</div>
                    <div class="tab" data-tab="withdraw">Вывод средств</div>
                </div>
                
                <div class="tab-content active" id="profile-tab">
                    <h3>Информация о профиле</h3>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="profile-email" readonly>
                    </div>
                    <div class="form-group">
                        <label>Тип аккаунта:</label>
                        <input type="text" id="account-type" readonly>
                    </div>
                    <button class="btn" id="change-password-btn">Сменить пароль</button>
                </div>
                
                <div class="tab-content" id="ads-tab">
                    <h3>Мои рекламные кампании</h3>
                    <div id="user-ads-list">
                        <!-- Список реклам пользователя -->
                    </div>
                    <button class="btn" id="create-ad-btn">Создать новую рекламу</button>
                </div>
                
                <div class="tab-content" id="withdraw-tab">
                    <h3>Вывод средств</h3>
                    <div class="form-group">
                        <label>Сумма для вывода:</label>
                        <input type="number" id="withdraw-amount" min="1">
                    </div>
                    <div class="form-group">
                        <label>DonationAlerts ссылка:</label>
                        <input type="text" id="donationalerts-link" placeholder="https://www.donationalerts.com/r/yourname">
                    </div>
                    <button class="btn" id="request-withdraw">Запросить вывод</button>
                </div>
            </div>
        </div>

        <!-- Админ-панель -->
        <div id="admin-page" class="tab-content">
            <div class="admin-panel">
                <h3>Админ-панель</h3>
                
                <div class="tabs">
                    <div class="tab active" data-tab="admin-users">Пользователи</div>
                    <div class="tab" data-tab="admin-ads">Рекламные заявки</div>
                    <div class="tab" data-tab="admin-support">Поддержка</div>
                    <div class="tab" data-tab="admin-withdrawals">Запросы на вывод</div>
                </div>
                
                <div class="tab-content active" id="admin-users-tab">
                    <h4>Управление пользователями</h4>
                    <div id="users-list">
                        <!-- Список пользователей -->
                    </div>
                </div>
                
                <div class="tab-content" id="admin-ads-tab">
                    <h4>Рекламные заявки</h4>
                    <div id="ads-requests-list">
                        <!-- Список заявок на рекламу -->
                    </div>
                </div>
                
                <div class="tab-content" id="admin-support-tab">
                    <h4>Запросы в поддержку</h4>
                    <div id="support-requests-list">
                        <!-- Список запросов в поддержку -->
                    </div>
                </div>
                
                <div class="tab-content" id="admin-withdrawals-tab">
                    <h4>Запросы на вывод средств</h4>
                    <div id="withdrawal-requests-list">
                        <!-- Список запросов на вывод -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Форма входа -->
        <div id="login-page" class="tab-content">
            <div class="card">
                <h2>Вход в аккаунт</h2>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="login-email">
                </div>
                <div class="form-group">
                    <label>Пароль:</label>
                    <input type="password" id="login-password">
                </div>
                <button class="btn" id="login-btn">Войти</button>
                <p>Нет аккаунта? <a href="#" id="go-to-register">Зарегистрироваться</a></p>
            </div>
        </div>

        <!-- Форма регистрации -->
        <div id="register-page" class="tab-content">
            <div class="card">
                <h2>Регистрация</h2>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="register-email">
                </div>
                <div class="form-group">
                    <label>Пароль:</label>
                    <input type="password" id="register-password">
                </div>
                <div class="form-group">
                    <label>Тип аккаунта:</label>
                    <select id="account-type-select">
                        <option value="user">Пользователь (размещение рекламы)</option>
                        <option value="advertiser">Рекламодатель (размещение своей рекламы)</option>
                    </select>
                </div>
                <button class="btn" id="register-btn">Зарегистрироваться</button>
                <p>Уже есть аккаунт? <a href="#" id="go-to-login">Войти</a></p>
            </div>
        </div>

        <!-- Форма создания рекламы -->
        <div id="create-ad-page" class="tab-content">
            <div class="card">
                <h2>Создание рекламной кампании</h2>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="ad-email">
                </div>
                <div class="form-group">
                    <label>Что рекламируете:</label>
                    <textarea id="ad-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Рекламный баннер (URL):</label>
                    <input type="text" id="ad-banner">
                </div>
                <div class="form-group">
                    <label>Тариф:</label>
                    <select id="ad-tariff">
                        <option value="super-economy">Супер эконом (30₽) - 12 часов</option>
                        <option value="economy">Эконом (120₽) - 24 часа</option>
                        <option value="medium">Средничок (500₽) - 6 дней</option>
                        <option value="pro">Профи (3.500₽) - 12 дней</option>
                        <option value="expert">Эксперт (7.500₽) - 24 дня</option>
                        <option value="business">Бизнесмен (30.000₽) - 48 дней</option>
                    </select>
                </div>
                <button class="btn" id="submit-ad-btn">Отправить на рассмотрение</button>
            </div>
        </div>

        <!-- Форма подтверждения статистики -->
        <div id="confirm-stats-page" class="tab-content">
            <div class="card">
                <h2>Подтверждение статистики</h2>
                <div class="form-group">
                    <label>ID рекламной кампании:</label>
                    <input type="text" id="ad-id" readonly>
                </div>
                <div class="form-group">
                    <label>Просмотры:</label>
                    <input type="number" id="ad-views" min="0">
                </div>
                <div class="form-group">
                    <label>Лайки:</label>
                    <input type="number" id="ad-likes" min="0">
                </div>
                <div class="form-group">
                    <label>Комментарии:</label>
                    <input type="number" id="ad-comments" min="0">
                </div>
                <div class="form-group">
                    <label>Юзер канала:</label>
                    <input type="text" id="channel-user" placeholder="@testchannel">
                </div>
                <div class="form-group">
                    <label>Ссылка на видео:</label>
                    <input type="text" id="video-link" placeholder="https://youtube.com/shorts/...">
                </div>
                <button class="btn" id="submit-stats-btn">Отправить статистику</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 ShortsAds - Платформа для размещения рекламы в YouTube Shorts</p>
        </div>
    </footer>

    <script>
        // Инициализация приложения
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация данных
            initApp();
            
            // Настройка обработчиков событий
            setupEventListeners();
            
            // Показать главную страницу
            showPage('home-page');
        });
        
        // Основные переменные
        let currentUser = null;
        let users = [];
        let ads = [];
        let supportMessages = [];
        let withdrawalRequests = [];
        
        // Тарифы с обновленным временем размещения
        const tariffs = {
            'super-economy': { name: 'Супер эконом', price: 30, duration: '12 часов', hours: 12 },
            'economy': { name: 'Эконом', price: 120, duration: '24 часа', hours: 24 },
            'medium': { name: 'Средничок', price: 500, duration: '6 дней', hours: 144 },
            'pro': { name: 'Профи', price: 3500, duration: '12 дней', hours: 288 },
            'expert': { name: 'Эксперт', price: 7500, duration: '24 дня', hours: 576 },
            'business': { name: 'Бизнесмен', price: 30000, duration: '48 дней', hours: 1152 }
        };
        
        // Инициализация приложения
        function initApp() {
            // Загрузка данных из localStorage
            loadData();
            
            // Создание админ аккаунта Minvy, если его нет
            if (!users.find(user => user.email === 'minvy@shortsads.com')) {
                const adminUser = {
                    id: generateId(),
                    email: 'minvy@shortsads.com',
                    password: encryptPassword('admin123'),
                    type: 'admin',
                    balance: 0,
                    registrationDate: new Date().toISOString()
                };
                users.push(adminUser);
                saveData();
            }
            
            // Обновление статистики на главной странице
            updateStats();
        }
        
        // Загрузка данных из localStorage
        function loadData() {
            const usersData = localStorage.getItem('shortsads_users');
            const adsData = localStorage.getItem('shortsads_ads');
            const supportData = localStorage.getItem('shortsads_support');
            const withdrawalsData = localStorage.getItem('shortsads_withdrawals');
            
            if (usersData) users = JSON.parse(usersData);
            if (adsData) ads = JSON.parse(adsData);
            if (supportData) supportMessages = JSON.parse(supportData);
            if (withdrawalsData) withdrawalRequests = JSON.parse(withdrawalsData);
        }
        
        // Сохранение данных в localStorage
        function saveData() {
            localStorage.setItem('shortsads_users', JSON.stringify(users));
            localStorage.setItem('shortsads_ads', JSON.stringify(ads));
            localStorage.setItem('shortsads_support', JSON.stringify(supportMessages));
            localStorage.setItem('shortsads_withdrawals', JSON.stringify(withdrawalRequests));
        }
        
        // Шифрование пароля (упрощенная версия для демонстрации)
        function encryptPassword(password) {
            // В реальном приложении используйте более надежное шифрование
            return btoa(password + 'shortsads_salt');
        }
        
        // Проверка пароля
        function checkPassword(inputPassword, encryptedPassword) {
            return encryptPassword(inputPassword) === encryptedPassword;
        }
        
        // Генерация ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }
        
        // Настройка обработчиков событий
        function setupEventListeners() {
            // Навигация
            document.getElementById('nav-home').addEventListener('click', () => showPage('home-page'));
            document.getElementById('nav-tariffs').addEventListener('click', () => showPage('tariffs-page'));
            document.getElementById('nav-support').addEventListener('click', () => {
                if (currentUser) {
                    showPage('support-page');
                    loadSupportChat();
                } else {
                    showPage('login-page');
                }
            });
            document.getElementById('nav-account').addEventListener('click', () => {
                if (currentUser) {
                    showPage('account-page');
                    updateAccountPage();
                } else {
                    showPage('login-page');
                }
            });
            document.getElementById('nav-admin').addEventListener('click', () => {
                if (currentUser && currentUser.type === 'admin') {
                    showPage('admin-page');
                    updateAdminPanel();
                }
            });
            document.getElementById('nav-login').addEventListener('click', () => showPage('login-page'));
            document.getElementById('nav-register').addEventListener('click', () => showPage('register-page'));
            document.getElementById('nav-logout').addEventListener('click', logout);
            
            // Кнопки входа и регистрации
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('register-btn').addEventListener('click', register);
            document.getElementById('go-to-register').addEventListener('click', () => showPage('register-page'));
            document.getElementById('go-to-login').addEventListener('click', () => showPage('login-page'));
            
            // Кнопка "Начать зарабатывать"
            document.getElementById('start-earning-btn').addEventListener('click', () => {
                if (currentUser) {
                    showPage('create-ad-page');
                } else {
                    showPage('register-page');
                }
            });
            
            // Кнопки выбора тарифов
            document.querySelectorAll('[data-tariff]').forEach(button => {
                button.addEventListener('click', function() {
                    const tariff = this.getAttribute('data-tariff');
                    selectTariff(tariff);
                });
            });
            
            // Поддержка
            document.getElementById('send-support-message').addEventListener('click', sendSupportMessage);
            
            // Вкладки в личном кабинете
            document.querySelectorAll('[data-tab]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Создание рекламы
            document.getElementById('create-ad-btn').addEventListener('click', () => showPage('create-ad-page'));
            document.getElementById('submit-ad-btn').addEventListener('click', submitAd);
            
            // Вывод средств
            document.getElementById('request-withdraw').addEventListener('click', requestWithdraw);
            
            // Подтверждение статистики
            document.getElementById('submit-stats-btn').addEventListener('click', submitStats);
        }
        
        // Показать страницу
        function showPage(pageId) {
            // Скрыть все страницы
            document.querySelectorAll('.tab-content').forEach(page => {
                page.classList.remove('active');
            });
            
            // Показать выбранную страницу
            document.getElementById(pageId).classList.add('active');
            
            // Обновить навигацию
            updateNavigation();
        }
        
        // Обновить навигацию
        function updateNavigation() {
            const navLogin = document.getElementById('nav-login');
            const navRegister = document.getElementById('nav-register');
            const navLogout = document.getElementById('nav-logout');
            const navAccount = document.getElementById('nav-account');
            const navAdmin = document.getElementById('nav-admin');
            
            if (currentUser) {
                navLogin.classList.add('hidden');
                navRegister.classList.add('hidden');
                navLogout.classList.remove('hidden');
                navAccount.classList.remove('hidden');
                
                if (currentUser.type === 'admin') {
                    navAdmin.classList.remove('hidden');
                } else {
                    navAdmin.classList.add('hidden');
                }
            } else {
                navLogin.classList.remove('hidden');
                navRegister.classList.remove('hidden');
                navLogout.classList.add('hidden');
                navAccount.classList.add('hidden');
                navAdmin.classList.add('hidden');
            }
        }
        
        // Вход в систему
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (!email || !password) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            const user = users.find(u => u.email === email);
            
            if (user && checkPassword(password, user.password)) {
                currentUser = user;
                showPage('home-page');
                updateStats();
                alert('Успешный вход!');
            } else {
                alert('Неверный email или пароль');
            }
        }
        
        // Регистрация
        function register() {
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const accountType = document.getElementById('account-type-select').value;
            
            if (!email || !password) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            if (users.find(u => u.email === email)) {
                alert('Пользователь с таким email уже существует');
                return;
            }
            
            const newUser = {
                id: generateId(),
                email: email,
                password: encryptPassword(password),
                type: accountType,
                balance: 0,
                registrationDate: new Date().toISOString()
            };
            
            users.push(newUser);
            saveData();
            
            alert('Регистрация прошла успешно! Теперь вы можете войти в систему.');
            showPage('login-page');
        }
        
        // Выход из системы
        function logout() {
            currentUser = null;
            showPage('home-page');
            updateStats();
        }
        
        // Выбор тарифа
        function selectTariff(tariff) {
            if (!currentUser) {
                showPage('login-page');
                return;
            }
            
            document.getElementById('ad-tariff').value = tariff;
            showPage('create-ad-page');
        }
        
        // Отправка заявки на рекламу
        function submitAd() {
            const email = document.getElementById('ad-email').value;
            const description = document.getElementById('ad-description').value;
            const banner = document.getElementById('ad-banner').value;
            const tariff = document.getElementById('ad-tariff').value;
            
            if (!email || !description || !banner) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            const ad = {
                id: generateId(),
                userId: currentUser.id,
                email: email,
                description: description,
                banner: banner,
                tariff: tariff,
                status: 'pending',
                createdAt: new Date().toISOString(),
                views: 0,
                likes: 0,
                comments: 0,
                earnings: 0
            };
            
            ads.push(ad);
            saveData();
            
            alert('Заявка на рекламу отправлена! Администратор рассмотрит ее в ближайшее время.');
            showPage('account-page');
            updateAccountPage();
        }
        
        // Обновление страницы аккаунта
        function updateAccountPage() {
            if (!currentUser) return;
            
            document.getElementById('profile-email').value = currentUser.email;
            document.getElementById('account-type').value = currentUser.type === 'admin' ? 'Администратор' : 
                                                           currentUser.type === 'advertiser' ? 'Рекламодатель' : 'Пользователь';
            document.getElementById('user-balance').textContent = currentUser.balance;
            
            // Обновление списка реклам
            const userAds = ads.filter(ad => ad.userId === currentUser.id);
            const adsList = document.getElementById('user-ads-list');
            adsList.innerHTML = '';
            
            if (userAds.length === 0) {
                adsList.innerHTML = '<p>У вас пока нет рекламных кампаний</p>';
            } else {
                userAds.forEach(ad => {
                    const adElement = document.createElement('div');
                    adElement.className = 'card';
                    adElement.innerHTML = `
                        <h4>${tariffs[ad.tariff].name}</h4>
                        <p><strong>Статус:</strong> ${getStatusText(ad.status)}</p>
                        <p><strong>Описание:</strong> ${ad.description}</p>
                        <p><strong>Просмотры:</strong> ${ad.views}</p>
                        <p><strong>Лайки:</strong> ${ad.likes}</p>
                        <p><strong>Комментарии:</strong> ${ad.comments}</p>
                        <p><strong>Заработано:</strong> ${ad.earnings}₽</p>
                        ${ad.status === 'active' ? `<button class="btn" onclick="confirmStats('${ad.id}')">Подтвердить статистику</button>` : ''}
                    `;
                    adsList.appendChild(adElement);
                });
            }
        }
        
        // Получить текст статуса
        function getStatusText(status) {
            switch(status) {
                case 'pending': return 'На рассмотрении';
                case 'approved': return 'Одобрено';
                case 'rejected': return 'Отклонено';
                case 'active': return 'Активно';
                case 'completed': return 'Завершено';
                default: return status;
            }
        }
        
        // Подтверждение статистики
        function confirmStats(adId) {
            const ad = ads.find(a => a.id === adId);
            if (!ad) return;
            
            document.getElementById('ad-id').value = ad.id;
            document.getElementById('ad-views').value = ad.views;
            document.getElementById('ad-likes').value = ad.likes;
            document.getElementById('ad-comments').value = ad.comments;
            
            showPage('confirm-stats-page');
        }
        
        // Отправка статистики
        function submitStats() {
            const adId = document.getElementById('ad-id').value;
            const views = parseInt(document.getElementById('ad-views').value) || 0;
            const likes = parseInt(document.getElementById('ad-likes').value) || 0;
            const comments = parseInt(document.getElementById('ad-comments').value) || 0;
            const channelUser = document.getElementById('channel-user').value;
            const videoLink = document.getElementById('video-link').value;
            
            if (!channelUser || !videoLink) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            const ad = ads.find(a => a.id === adId);
            if (!ad) return;
            
            // Расчет дохода
            const earnings = views * 0.005 + likes * 0.01 + comments * 0.02;
            
            // Обновление статистики
            ad.views = views;
            ad.likes = likes;
            ad.comments = comments;
            ad.earnings = earnings;
            
            // Добавление дохода к балансу пользователя
            const user = users.find(u => u.id === currentUser.id);
            if (user) {
                user.balance += earnings;
            }
            
            saveData();
            
            alert(`Статистика отправлена! Ваш доход: ${earnings.toFixed(2)}₽`);
            showPage('account-page');
            updateAccountPage();
        }
        
        // Запрос на вывод средств
        function requestWithdraw() {
            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            const donationalertsLink = document.getElementById('donationalerts-link').value;
            
            if (!amount || amount <= 0) {
                alert('Пожалуйста, укажите корректную сумму для вывода');
                return;
            }
            
            if (!donationalertsLink) {
                alert('Пожалуйста, укажите ссылку на DonationAlerts');
                return;
            }
            
            if (amount > currentUser.balance) {
                alert('Недостаточно средств на балансе');
                return;
            }
            
            const withdrawalRequest = {
                id: generateId(),
                userId: currentUser.id,
                email: currentUser.email,
                amount: amount,
                donationalertsLink: donationalertsLink,
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            
            withdrawalRequests.push(withdrawalRequest);
            saveData();
            
            alert('Запрос на вывод средств отправлен! Администратор обработает его в ближайшее время.');
            document.getElementById('withdraw-amount').value = '';
            document.getElementById('donationalerts-link').value = '';
        }
        
        // Загрузка чата поддержки
        function loadSupportChat() {
            const chat = document.getElementById('support-chat');
            chat.innerHTML = '';
            
            const userMessages = supportMessages.filter(msg => 
                msg.userId === currentUser.id || (currentUser.type === 'admin' && msg.adminResponse)
            );
            
            if (userMessages.length === 0) {
                chat.innerHTML = '<p>Пока нет сообщений. Начните общение!</p>';
            } else {
                userMessages.forEach(msg => {
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${msg.userId === currentUser.id ? 'user-message' : 'admin-message'}`;
                    messageElement.innerHTML = `
                        <p><strong>${msg.userId === currentUser.id ? 'Вы' : 'Администратор'}:</strong></p>
                        <p>${msg.message}</p>
                        <small>${new Date(msg.timestamp).toLocaleString()}</small>
                    `;
                    chat.appendChild(messageElement);
                });
            }
            
            chat.scrollTop = chat.scrollHeight;
        }
        
        // Отправка сообщения в поддержку
        function sendSupportMessage() {
            const message = document.getElementById('support-message').value;
            
            if (!message) {
                alert('Пожалуйста, введите сообщение');
                return;
            }
            
            const supportMessage = {
                id: generateId(),
                userId: currentUser.id,
                message: message,
                timestamp: new Date().toISOString(),
                adminResponse: currentUser.type === 'admin'
            };
            
            supportMessages.push(supportMessage);
            saveData();
            
            document.getElementById('support-message').value = '';
            loadSupportChat();
        }
        
        // Переключение вкладок
        function switchTab(tabName) {
            // Скрыть все вкладки
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Убрать активный класс со всех вкладок
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Показать выбранную вкладку
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Добавить активный класс к выбранной вкладке
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Если это вкладка админ-панели, обновить ее
            if (tabName.startsWith('admin-')) {
                updateAdminPanel();
            }
        }
        
        // Обновление админ-панели
        function updateAdminPanel() {
            if (!currentUser || currentUser.type !== 'admin') return;
            
            // Обновление списка пользователей
            updateUsersList();
            
            // Обновление списка заявок на рекламу
            updateAdsRequestsList();
            
            // Обновление списка запросов в поддержку
            updateSupportRequestsList();
            
            // Обновление списка запросов на вывод
            updateWithdrawalRequestsList();
        }
        
        // Обновление списка пользователей
        function updateUsersList() {
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';
            
            users.forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'card';
                userElement.innerHTML = `
                    <h4>${user.email}</h4>
                    <p><strong>Тип:</strong> ${user.type}</p>
                    <p><strong>Баланс:</strong> ${user.balance}₽</p>
                    <p><strong>Дата регистрации:</strong> ${new Date(user.registrationDate).toLocaleDateString()}</p>
                    ${user.type !== 'admin' ? `<button class="btn" onclick="makeAdmin('${user.id}')">Сделать администратором</button>` : ''}
                    ${user.type !== 'admin' ? `<button class="btn btn-success" onclick="addBalance('${user.id}')">Пополнить баланс</button>` : ''}
                `;
                usersList.appendChild(userElement);
            });
        }
        
        // Обновление списка заявок на рекламу
        function updateAdsRequestsList() {
            const adsList = document.getElementById('ads-requests-list');
            adsList.innerHTML = '';
            
            const pendingAds = ads.filter(ad => ad.status === 'pending');
            
            if (pendingAds.length === 0) {
                adsList.innerHTML = '<p>Нет заявок на рассмотрение</p>';
            } else {
                pendingAds.forEach(ad => {
                    const user = users.find(u => u.id === ad.userId);
                    const adElement = document.createElement('div');
                    adElement.className = 'card';
                    adElement.innerHTML = `
                        <h4>${user ? user.email : 'Неизвестный пользователь'} - ${tariffs[ad.tariff].name}</h4>
                        <p><strong>Что рекламирует:</strong> ${ad.description}</p>
                        <p><strong>Баннер:</strong> ${ad.banner}</p>
                        <p><strong>Тариф:</strong> ${tariffs[ad.tariff].name} (${tariffs[ad.tariff].price}₽)</p>
                        <p><strong>Длительность:</strong> ${tariffs[ad.tariff].duration}</p>
                        <button class="btn btn-success" onclick="approveAd('${ad.id}')">Одобрить</button>
                        <button class="btn btn-danger" onclick="rejectAd('${ad.id}')">Отклонить</button>
                    `;
                    adsList.appendChild(adElement);
                });
            }
        }
        
        // Обновление списка запросов в поддержку
        function updateSupportRequestsList() {
            const supportList = document.getElementById('support-requests-list');
            supportList.innerHTML = '';
            
            const userMessages = supportMessages.filter(msg => !msg.adminResponse);
            
            if (userMessages.length === 0) {
                supportList.innerHTML = '<p>Нет новых запросов в поддержку</p>';
            } else {
                userMessages.forEach(msg => {
                    const user = users.find(u => u.id === msg.userId);
                    const messageElement = document.createElement('div');
                    messageElement.className = 'card';
                    messageElement.innerHTML = `
                        <h4>${user ? user.email : 'Неизвестный пользователь'}</h4>
                        <p>${msg.message}</p>
                        <small>${new Date(msg.timestamp).toLocaleString()}</small>
                        <div class="form-group">
                            <textarea id="response-${msg.id}" placeholder="Введите ответ..." rows="2"></textarea>
                        </div>
                        <button class="btn" onclick="sendAdminResponse('${msg.id}')">Ответить</button>
                    `;
                    supportList.appendChild(messageElement);
                });
            }
        }
        
        // Обновление списка запросов на вывод
        function updateWithdrawalRequestsList() {
            const withdrawalsList = document.getElementById('withdrawal-requests-list');
            withdrawalsList.innerHTML = '';
            
            const pendingWithdrawals = withdrawalRequests.filter(req => req.status === 'pending');
            
            if (pendingWithdrawals.length === 0) {
                withdrawalsList.innerHTML = '<p>Нет запросов на вывод средств</p>';
            } else {
                pendingWithdrawals.forEach(req => {
                    const user = users.find(u => u.id === req.userId);
                    const withdrawalElement = document.createElement('div');
                    withdrawalElement.className = 'card';
                    withdrawalElement.innerHTML = `
                        <h4>${user ? user.email : 'Неизвестный пользователь'}</h4>
                        <p><strong>Сумма:</strong> ${req.amount}₽</p>
                        <p><strong>DonationAlerts:</strong> ${req.donationalertsLink}</p>
                        <p><strong>Дата запроса:</strong> ${new Date(req.createdAt).toLocaleString()}</p>
                        <button class="btn btn-success" onclick="approveWithdrawal('${req.id}')">Выполнить</button>
                        <button class="btn btn-danger" onclick="rejectWithdrawal('${req.id}')">Отклонить</button>
                    `;
                    withdrawalsList.appendChild(withdrawalElement);
                });
            }
        }
        
        // Админ: Сделать пользователя администратором
        function makeAdmin(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                user.type = 'admin';
                saveData();
                updateAdminPanel();
                alert('Пользователь теперь администратор');
            }
        }
        
        // Админ: Пополнить баланс пользователя
        function addBalance(userId) {
            const amount = prompt('Введите сумму для пополнения:');
            if (!amount || isNaN(amount) || amount <= 0) {
                alert('Некорректная сумма');
                return;
            }
            
            const user = users.find(u => u.id === userId);
            if (user) {
                user.balance += parseFloat(amount);
                saveData();
                updateAdminPanel();
                alert(`Баланс пользователя пополнен на ${amount}₽`);
            }
        }
        
        // Админ: Одобрить рекламу
        function approveAd(adId) {
            const ad = ads.find(a => a.id === adId);
            if (ad) {
                ad.status = 'approved';
                saveData();
                updateAdminPanel();
                alert('Реклама одобрена');
            }
        }
        
        // Админ: Отклонить рекламу
        function rejectAd(adId) {
            const ad = ads.find(a => a.id === adId);
            if (ad) {
                ad.status = 'rejected';
                saveData();
                updateAdminPanel();
                alert('Реклама отклонена');
            }
        }
        
        // Админ: Отправить ответ в поддержку
        function sendAdminResponse(messageId) {
            const response = document.getElementById(`response-${messageId}`).value;
            if (!response) {
                alert('Пожалуйста, введите ответ');
                return;
            }
            
            const supportMessage = {
                id: generateId(),
                userId: currentUser.id,
                message: response,
                timestamp: new Date().toISOString(),
                adminResponse: true,
                originalMessageId: messageId
            };
            
            supportMessages.push(supportMessage);
            saveData();
            
            document.getElementById(`response-${messageId}`).value = '';
            updateAdminPanel();
            alert('Ответ отправлен');
        }
        
        // Админ: Одобрить вывод средств
        function approveWithdrawal(requestId) {
            const request = withdrawalRequests.find(req => req.id === requestId);
            if (request) {
                const user = users.find(u => u.id === request.userId);
                if (user) {
                    if (user.balance >= request.amount) {
                        user.balance -= request.amount;
                        request.status = 'completed';
                        saveData();
                        updateAdminPanel();
                        alert('Вывод средств выполнен');
                    } else {
                        alert('Недостаточно средств у пользователя');
                    }
                }
            }
        }
        
        // Админ: Отклонить вывод средств
        function rejectWithdrawal(requestId) {
            const request = withdrawalRequests.find(req => req.id === requestId);
            if (request) {
                request.status = 'rejected';
                saveData();
                updateAdminPanel();
                alert('Запрос на вывод отклонен');
            }
        }
        
        // Обновление статистики на главной странице
        function updateStats() {
            document.getElementById('total-users').textContent = users.length;
            document.getElementById('total-ads').textContent = ads.length;
            
            const totalEarnings = ads.reduce((sum, ad) => sum + ad.earnings, 0);
            document.getElementById('total-earnings').textContent = totalEarnings.toFixed(2) + '₽';
        }
    </script>
</body>
  </html> 
